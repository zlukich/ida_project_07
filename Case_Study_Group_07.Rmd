---
title: "Case Study Group 07"
author: "Domenica Ginnette Ruales Cevallos, Rhesa Edrick Tendean, Oleksandr Soboliev, Ines Kueta Notsa"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Description of Study Case

A large car dealership is about to open a new branch in Dortmund. We are tasked to select the choice of cars between OEM1 and OEM2. The goal of this new car dealership selection is to increase the sales figure after a long period of low sales. For this, our team must analyze the registrations of the last three years from 2014 until 2016. In this selection, neighboring towns of Bochum Gelsenkirchen, Hilden and Nordkirchen should be considered. Important criterias for this selection are sales figures and susceptibility to errors.

## Libraries

At first, we need to install and load the package `install.load` to ease the loading process of relevant packages, that are used in this study case.

```{r message = FALSE, warning = FALSE}
if(!require(install.load)){
  install.packages("install.load")
  library(install.load)
}


install_load("tidyverse", "lubridate", "plotly", "shiny", "leaflet", "data.table")

if ("fitdistrplus" %in% (.packages())){
detach(package: fitdistrplus, unload = TRUE)
}

if ("fitdistrplus" %in% (.packages())){
detach(package: MASS, unload = TRUE)
}

if ("fitdistrplus" %in% (.packages())){
detach(package: stats, unload = TRUE)
}

```

## 0. Functions
Merge .x and .y columns of a component dataset
```{r message = FALSE, warning = FALSE}
merge_xy <- function(data) {
  data_x <- data[,1:2] %>% na.omit(1) %>% rename(V1 = 1, V2 = 2)
  data_y <- data[,3:4] %>% na.omit(1) %>% rename(V1 = 1, V2 = 2)
  
  data <- bind_rows(data_x, data_y)
}
```


## 1. Import all relevant datasets

Importing of all vehicles from OEM1 and 2. Relevant columns: ID_Fahrzeug, Herstellernummer, Fehlerhaft

```{r message = FALSE, warning = FALSE}
fahrzeuge_oem1_typ11 <- fread("Data/Fahrzeug/Fahrzeuge_OEM1_Typ11.csv") %>% select(3, 5, 7)
fahrzeuge_oem1_typ12 <- fread("Data/Fahrzeug/Fahrzeuge_OEM1_Typ12.csv") %>% select(3, 5, 7)
fahrzeuge_oem2_typ21 <- fread("Data/Fahrzeug/Fahrzeuge_OEM2_Typ21.csv") %>% select(3, 4, 6)
fahrzeuge_oem2_typ22 <- fread("Data/Fahrzeug/Fahrzeuge_OEM2_Typ22.csv") %>% select(3, 4, 6)

```

Importing of registered vehicles (Zulassungen_alle_Fahrzeuge.csv): ID_Nummer, Gemeinden, Zulassung
```{r message = FALSE, warning = FALSE}
zulassungen <- fread("Data/Zulassungen/Zulassungen_alle_Fahrzeuge.csv") %>% select(-1)

```

Importing component list of all vehicles (Bestandteile Fahrzeuge *): ID_Fahrzeug, ID_Karosserie, ID_Schaltung, ID_Sitze, ID_Motor

```{r message = FALSE, warning = FALSE}
bestandteile_fahrzeuge_oem1_typ11 <- fread("Data/Fahrzeug/Bestandteile_Fahrzeuge_OEM1_Typ11.csv", header = TRUE) %>% 
  select(6, 2:5)
bestandteile_fahrzeuge_oem1_typ12 <- fread("Data/Fahrzeug/Bestandteile_Fahrzeuge_OEM1_Typ12.csv", header = TRUE) %>% 
  select(6, 2:5)
bestandteile_fahrzeuge_oem2_typ21 <- fread("Data/Fahrzeug/Bestandteile_Fahrzeuge_OEM2_Typ21.csv", header = TRUE) %>% 
  select(6, 2:5)
bestandteile_fahrzeuge_oem2_typ22 <- fread("Data/Fahrzeug/Bestandteile_Fahrzeuge_OEM2_Typ22.csv", header = TRUE) %>% 
  select(6, 2:5)
```

Importing component K1* (Motor): ID_Motor, Fehlerhaft

```{r message = FALSE, warning = FALSE}
# Motor Dataset
komponente_k1be1 <- fread("Data/Komponente/Komponente_K1BE1.csv") %>% select(3,6)

komponente_k1be2 <- fread("Data/Komponente/Komponente_K1BE2.csv") %>% select(3,6)

komponente_k1di1 <- fread("Data/Komponente/Komponente_K1DI1.csv") %>% 
  select(3, 7, 10, 14) %>% 
  merge_xy() %>% 
  rename(ID_Motor = V1, Fehlerhaft = V2)

komponente_k1di2 <- fread("Data/Komponente/Komponente_K3AG2.txt", sep = "\\") %>% select(3,6)

```

Importing component K2* (Sitze): ID_Sitze, Fehlerhaft

```{r message = FALSE, warning = FALSE}
# Sitze Dataset
komponente_k2le1 <- read_file("Data/Komponente/Komponente_K2LE1.txt") %>% 
  str_replace_all("[:cntrl:]", "\n") %>% 
  str_replace_all("II", ";") %>% 
  fread() %>% 
  select(3, 7, 10, 14) %>% 
  merge_xy() %>% 
  rename(ID_Sitze = V1, Fehlerhaft = V2)

komponente_k2le2 <- fread("Data/Komponente/Komponente_K2LE2.txt", sep = "\\") %>% select(3,6)

komponente_k2st1 <- fread("Data/Komponente/Komponente_K2ST1.txt") %>% select(3,7)

komponente_k2st2 <- fread("Data/Komponente/Komponente_K2ST2.csv") %>% select(3,6)
```

Importing component K3* (Schaltung): ID_Schaltung, Fehlerhaft
```{r message = FALSE, warning = FALSE}
# Schaltung Dataset
komponente_k3ag1 <- fread("Data/Komponente/Komponente_K3AG1.csv") %>% 
  select(3, 7, 10, 14) %>% 
  merge_xy() %>% 
  rename(ID_Schaltung = V1, Fehlerhaft = V2)

komponente_k3ag2 <- fread("Data/Komponente/Komponente_K3AG2.txt", sep = "\\") %>% select(3,6)

komponente_k3sg1 <- fread("Data/Komponente/Komponente_K3SG1.csv") %>% 
  select(3, 7, 10, 14) %>% 
  merge_xy() %>% 
  rename(ID_Schaltung = V1, Fehlerhaft = V2)

komponente_k3sg2 <- fread("Data/Komponente/Komponente_K3SG2.csv") %>% select(3,6)
```

Importing component K4 - K7 (Karosserie): ID_Karosserie, Fehlerhaft
```{r message = FALSE, warning = FALSE}
# Karosserie Dataset
komponente_k4 <- fread("Data/Komponente/Komponente_K4.csv") %>% 
  select(3, 7, 10, 14) %>% 
  merge_xy() %>% 
  rename(ID_Karosserie = V1, Fehlerhaft = V2)

komponente_k5 <- fread("Data/Komponente/Komponente_K5.csv") %>% 
  select(3, 7, 10, 14) %>% 
  merge_xy() %>% 
  rename(ID_Karosserie = V1, Fehlerhaft = V2)

komponente_k6 <- fread("Data/Komponente/Komponente_K6.csv") %>% select(3,6)
komponente_k7 <- fread("Data/Komponente/Komponente_K7.txt") %>% select(3,6)
```

Importing list of single components (Bestandteile Komponente *)

```{r message = FALSE, warning = FALSE}
# Component List of each components
bestandteile_komponente_k1be1 <- fread("Data/Komponente/Bestandteile_Komponente_K1BE1.csv", header = TRUE) %>% 
  select(-1)
bestandteile_komponente_k1be2 <- fread("Data/Komponente/Bestandteile_Komponente_K1BE2.csv", header = TRUE) %>% 
  select(-1)
bestandteile_komponente_k1di1 <- fread("Data/Komponente/Bestandteile_Komponente_K1DI1.csv", header = TRUE) %>% 
  select(-1)
bestandteile_komponente_k1di2 <- fread("Data/Komponente/Bestandteile_Komponente_K1DI2.csv", header = TRUE) %>% 
  select(-1)

bestandteile_komponente_k2le1 <- fread("Data/Komponente/Bestandteile_Komponente_K2LE1.csv", header = TRUE) %>% 
  select(-1)
bestandteile_komponente_k2le2 <- fread("Data/Komponente/Bestandteile_Komponente_K2LE2.csv", header = TRUE) %>% 
  select(-1)
bestandteile_komponente_k2st1 <- fread("Data/Komponente/Bestandteile_Komponente_K2ST1.csv", header = TRUE) %>% 
  select(-c(1,2))
bestandteile_komponente_k2st2 <- fread("Data/Komponente/Bestandteile_Komponente_K2ST2.csv", header = TRUE) %>% 
  select(-1)

bestandteile_komponente_k3ag1 <- fread("Data/Komponente/Bestandteile_Komponente_K3AG1.csv", header = TRUE) %>% 
  select(-1)
bestandteile_komponente_k3ag2 <- fread("Data/Komponente/Bestandteile_Komponente_K3AG2.csv", header = TRUE) %>% 
  select(-1)
bestandteile_komponente_k3sg1 <- fread("Data/Komponente/Bestandteile_Komponente_K3SG1.csv", header = TRUE) %>% 
  select(-1)
bestandteile_komponente_k3sg2 <- fread("Data/Komponente/Bestandteile_Komponente_K3SG2.csv", header = TRUE) %>% 
  select(-1)

bestandteile_komponente_k4 <- fread("Data/Komponente/Bestandteile_Komponente_K4.csv", header = TRUE) %>% 
  select(-1)
bestandteile_komponente_k5 <- fread("Data/Komponente/Bestandteile_Komponente_K5.csv", header = TRUE) %>% 
  select(-1)
bestandteile_komponente_k6 <- fread("Data/Komponente/Bestandteile_Komponente_K6.csv", header = TRUE) %>% 
  select(-1)
bestandteile_komponente_k7 <- fread("Data/Komponente/Bestandteile_Komponente_K7.csv", header = TRUE) %>% 
  select(-1)

```

Importing all single components (Einzelteil): ID_, Fehlerhaft

```{r message = FALSE, warning = FALSE}
# Single component dataset
einzelteil_t01 <- read_file("Data/Einzelteil/Einzelteil_T01.txt") %>% 
  str_replace_all(" \\| \\| ", ";") %>%
  str_replace_all(" ", "\n") %>% 
  fread() %>% 
  select(3, 7, 10, 14) %>% 
  merge_xy() %>% 
  rename(ID_T01 = V1, Fehlerhaft = V2)

einzelteil_t02 <- read_file("Data/Einzelteil/Einzelteil_T02.txt") %>% 
  str_replace_all("\t", "\n") %>%
  str_replace_all("  ", ";") %>% 
  fread() %>% 
  select(3, 7, 10, 14) %>% 
  merge_xy() %>% 
  rename(ID_T02 = V1, Fehlerhaft = V2)

einzelteil_t03 <- read_file("Data/Einzelteil/Einzelteil_T03.txt") %>% 
  str_replace_all("[:cntrl:]", "\n") %>%
  str_replace_all("\\|", ";") %>%
  fread() %>% 
  select(3,6)

einzelteil_t04 <- fread("Data/Einzelteil/Einzelteil_T04.csv") %>% select(3,6)
einzelteil_t05 <- fread("Data/Einzelteil/Einzelteil_T05.csv") %>% 
  select(3, 7, 10, 14) %>% 
  merge_xy() %>% 
  rename(ID_T05 = V1, Fehlerhaft = V2)

einzelteil_t06 <- fread("Data/Einzelteil/Einzelteil_T06.csv") %>% select(3,6)

einzelteil_t07 <- read_file("Data/Einzelteil/Einzelteil_T07.txt") %>% 
  str_replace_all("\"\"", "\"\n\"") %>% 
  fread() %>% 
  select(3,6)

einzelteil_t08 <- fread("Data/Einzelteil/Einzelteil_T08.csv") %>% select(3,6)

einzelteil_t09 <- read_file("Data/Einzelteil/Einzelteil_T09.txt") %>% 
  str_replace_all("[:cntrl:]", "\n") %>% 
  fread(sep = "\\") %>% 
  select(3, 7, 10, 14) %>% 
  merge_xy() %>% 
  rename(ID_T09 = V1, Fehlerhaft = V2)

einzelteil_t10 <- fread("Data/Einzelteil/Einzelteil_T10.csv") %>% select(3,6)

einzelteil_t11 <- read_file("Data/Einzelteil/Einzelteil_T11.txt") %>% 
  str_replace_all("\t", ";") %>% 
  str_replace_all("[:cntrl:]", "\n") %>%
  fread() %>% 
  select(3,6)

einzelteil_t12 <- fread("Data/Einzelteil/Einzelteil_T12.csv") %>% 
  select(3, 7, 10, 14) %>% 
  merge_xy() %>% 
  rename(ID_T12 = V1, Fehlerhaft = V2)

einzelteil_t13 <- fread("Data/Einzelteil/Einzelteil_T13.csv", dec = ",") %>% select(3,6)
einzelteil_t14 <- fread("Data/Einzelteil/Einzelteil_T14.csv", dec = ",") %>% select(3,6)
einzelteil_t15 <- fread("Data/Einzelteil/Einzelteil_T15.csv", dec = ",") %>% 
  select(3, 7, 10, 14) %>% 
  merge_xy() %>% 
  rename(ID_T15 = V1, Fehlerhaft = V2)

einzelteil_t16 <- read_file("Data/Einzelteil/Einzelteil_T16.txt") %>% 
  str_replace_all(" \\| \\| ", ";") %>% 
  str_replace_all("\t", "\n") %>%
  fread() %>% 
  select(3, 7, 10, 14) %>% 
  merge_xy() %>% 
  rename(ID_T16 = V1, Fehlerhaft = V2)

einzelteil_t17 <- fread("Data/Einzelteil/Einzelteil_T17.csv", dec = ",") %>% 
  select(3, 7, 10, 14) %>% 
  merge_xy() %>% 
  rename(ID_T17 = V1, Fehlerhaft = V2)

einzelteil_t18 <- fread("Data/Einzelteil/Einzelteil_T18.csv", dec = ",") %>% select(3,6)

einzelteil_t19 <- fread("Data/Einzelteil/Einzelteil_T19.csv") %>% select(3,6)

einzelteil_t20 <- read_file("Data/Einzelteil/Einzelteil_T16.txt") %>% 
  str_replace_all(" \\| \\| ", ";") %>% 
  str_replace_all("\t", "\n") %>%
  fread() %>% 
  select(3, 7, 10, 14) %>% 
  merge_xy() %>% 
  rename(ID_T20 = V1, Fehlerhaft = V2)

einzelteil_t21 <- fread("Data/Einzelteil/Einzelteil_T21.csv", dec = ",") %>% select(3,6)

einzelteil_t22 <- read_file("Data/Einzelteil/Einzelteil_T22.txt") %>% 
  #str_replace_all("\t", ";") %>% 
  str_replace_all("NA\"", "\n\"") %>%
  str_replace_all("\"\"", "\"\n\"") %>%
  str_replace_all("NA\t0\"", "NA\t0\n\"") %>%
  str_replace_all("(?<=\\d)\"(?=\\d)", "\n\"") %>%
  fread() %>% 
  select(3, 7, 10, 14) %>% 
  merge_xy() %>% 
  rename(ID_T22 = V1, Fehlerhaft = V2)

einzelteil_t23 <- fread("Data/Einzelteil/Einzelteil_T23.csv", dec = ",") %>% 
  select(3, 7, 10, 14) %>% 
  merge_xy() %>% 
  rename(ID_T23 = V1, Fehlerhaft = V2)

einzelteil_t24 <- read_file("Data/Einzelteil/Einzelteil_T24.txt") %>% 
  str_replace_all("   ", ";") %>% 
  str_replace_all("[:cntrl:]", "\n") %>%
  fread() %>% 
  select(3, 7, 10, 14) %>% 
  merge_xy() %>% 
  rename(ID_T24 = V1, Fehlerhaft = V2)

einzelteil_t25 <- fread("Data/Einzelteil/Einzelteil_T25.csv", dec = ",") %>% select(3,6)

einzelteil_t26 <- fread("Data/Einzelteil/Einzelteil_T26.csv", dec = ",") %>% select(3,6)

einzelteil_t27 <- read_file("Data/Einzelteil/Einzelteil_T27.txt") %>% 
  str_replace_all(" \\| \\| ", ";") %>% 
  str_replace_all("[:cntrl:]", "\n") %>%
  fread() %>% 
  select(3,6)

einzelteil_t30 <- fread("Data/Einzelteil/Einzelteil_T30.csv") %>% 
  select(3, 7, 10, 14) %>% 
  merge_xy() %>% 
  rename(ID_T30 = V1, Fehlerhaft = V2)

einzelteil_t31 <- read_file("Data/Einzelteil/Einzelteil_T31.txt") %>% 
  str_replace_all("  ", ";") %>% 
  str_replace_all("[:cntrl:]", "\n") %>%
  fread() %>% 
  select(3,6)

einzelteil_t32 <- fread("Data/Einzelteil/Einzelteil_T32.csv", dec = ",") %>% 
  select(3, 7, 10, 14) %>% 
  merge_xy() %>% 
  rename(ID_T32 = V1, Fehlerhaft = V2)

einzelteil_t33 <- fread("Data/Einzelteil/Einzelteil_T33.csv") %>% select(3,6)

einzelteil_t34 <- read_file("Data/Einzelteil/Einzelteil_T34.txt") %>% 
  str_replace_all(" \\| \\| ", ";") %>% 
  str_replace_all("\"\"", "\"\n\"") %>%
  fread() %>% 
  select(3,6)

einzelteil_t35 <- read_file("Data/Einzelteil/Einzelteil_T35.txt") %>% 
  str_replace_all("\"\"", "\"\n\"") %>%
  str_replace_all("NA\"", "\n\"") %>%
  str_replace_all("(?<=\\d)\"(?=\\d)", "\n\"") %>%
  fread(sep = "\\") %>% 
  select(3, 7, 10, 14) %>% 
  merge_xy() %>% 
  rename(ID_T35 = V1, Fehlerhaft = V2)

einzelteil_t36 <- read_file("Data/Einzelteil/Einzelteil_T36.txt") %>% 
  str_replace_all("  ", ";") %>% 
  str_replace_all(" ", "\n") %>%
  fread() %>% 
  select(3,6)

einzelteil_t37 <- fread("Data/Einzelteil/Einzelteil_T37.csv") %>% select(3,6)

einzelteil_t38 <- fread("Data/Einzelteil/Einzelteil_T38.csv") %>% 
  select(3, 7, 10, 14) %>% 
  merge_xy() %>% 
  rename(ID_T35 = V1, Fehlerhaft = V2)

einzelteil_t39 <- read_file("Data/Einzelteil/Einzelteil_T39.txt") %>% 
  str_replace_all("[:cntrl:]", "\n") %>%
  fread(sep = "\\") %>% 
  select(3, 7, 10, 14) %>% 
  merge_xy() %>% 
  rename(ID_T35 = V1, Fehlerhaft = V2)

einzelteil_t40 <- fread("Data/Einzelteil/Einzelteil_T40.csv") %>% select(3,6)


```

## 2. Data preparation

### Data preparation for single component (Einzelteil)
All single component (Einzelkomponente) are joined into one single data:
```{r message = FALSE, warning = FALSE}
einzelteil_all <- rbind(einzelteil_t01,einzelteil_t02,einzelteil_t03,einzelteil_t04,einzelteil_t05,
                        einzelteil_t06,einzelteil_t07,einzelteil_t08,einzelteil_t09,einzelteil_t10,
                        einzelteil_t11,einzelteil_t12,einzelteil_t13,einzelteil_t14,einzelteil_t15,
                        einzelteil_t16,einzelteil_t17,einzelteil_t18,einzelteil_t19,einzelteil_t20,
                        einzelteil_t21,einzelteil_t22,einzelteil_t23,einzelteil_t24,einzelteil_t25,
                        einzelteil_t26,einzelteil_t27, einzelteil_t30,
                        einzelteil_t31,einzelteil_t32,einzelteil_t33,einzelteil_t34,einzelteil_t35,
                        einzelteil_t36,einzelteil_t37,einzelteil_t38,einzelteil_t39,einzelteil_t40, 
                        use.names = FALSE) %>% rename(ID_T = 1)

rm(einzelteil_t01,einzelteil_t02,einzelteil_t03,einzelteil_t04,einzelteil_t05,
   einzelteil_t06,einzelteil_t07,einzelteil_t08,einzelteil_t09,einzelteil_t10,
   einzelteil_t11,einzelteil_t12,einzelteil_t13,einzelteil_t14,einzelteil_t15,
   einzelteil_t16,einzelteil_t17,einzelteil_t18,einzelteil_t19,einzelteil_t20,
   einzelteil_t21,einzelteil_t22,einzelteil_t23,einzelteil_t24,einzelteil_t25,
   einzelteil_t26,einzelteil_t27, einzelteil_t30,
   einzelteil_t31,einzelteil_t32,einzelteil_t33,einzelteil_t34,einzelteil_t35,
   einzelteil_t36,einzelteil_t37,einzelteil_t38,einzelteil_t39,einzelteil_t40)
```

All vehicle component (Komponente) are joined into one single data:
```{r message = FALSE, warning = FALSE}
komponente_all <- rbind(komponente_k1be1, komponente_k1be2, komponente_k1di1, komponente_k1di2,
                        komponente_k2le1, komponente_k2le2, komponente_k2st1, komponente_k2st2,
                        komponente_k3ag1, komponente_k3ag2, komponente_k3sg1, komponente_k3sg2,
                        komponente_k4, komponente_k5, komponente_k6, komponente_k7,
                        use.names = FALSE) %>% rename(ID_K = 1)

rm(komponente_k1be1, komponente_k1be2, komponente_k1di1, komponente_k1di2,
   komponente_k2le1, komponente_k2le2, komponente_k2st1, komponente_k2st2,
   komponente_k3ag1, komponente_k3ag2, komponente_k3sg1, komponente_k3sg2,
   komponente_k4, komponente_k5, komponente_k6, komponente_k7)

```

All vehicle (Fahrzeuge) are joined into one single data:

```{r message = FALSE, warning = FALSE}
fahrzeuge_all <- rbind(fahrzeuge_oem1_typ11,
                       fahrzeuge_oem1_typ12,
                       fahrzeuge_oem2_typ21,
                       fahrzeuge_oem2_typ22)

rm(fahrzeuge_oem1_typ11,
   fahrzeuge_oem1_typ12,
   fahrzeuge_oem2_typ21,
   fahrzeuge_oem2_typ22)
```

All vehicle component list (Bestandteile Fahrzeuge) are joined into one single data:
```{r message = FALSE, warning = FALSE}
bestandteile_fahrzeuge_all <- rbind(bestandteile_fahrzeuge_oem1_typ11,
                                    bestandteile_fahrzeuge_oem1_typ12,
                                    bestandteile_fahrzeuge_oem2_typ21,
                                    bestandteile_fahrzeuge_oem2_typ22)

rm(bestandteile_fahrzeuge_oem1_typ11,
   bestandteile_fahrzeuge_oem1_typ12,
   bestandteile_fahrzeuge_oem2_typ21,
   bestandteile_fahrzeuge_oem2_typ22)
```

Filter vehicle registration for the year 2014 - 2016 in Dortmund, Bochum, Gelsenkirchen, Hilden and Nordkirchen.

```{r message = FALSE, warning = FALSE}
zulassungen_filter <- zulassungen %>% 
  filter(Gemeinden %in% c("DORTMUND", "BOCHUM", "GELSENKIRCHEN", "HILDEN", "NORDKIRCHEN")) %>% 
  filter(Zulassung >= "2014-01-01" & Zulassung <= "2016-12-31") %>% 
  arrange(Zulassung, IDNummer)
 ```


## 3. Final data set

```{r message = FALSE, warning = FALSE}
zulassungen_oem1_typ11 <- zulassungen_filter %>% 
  inner_join(fahrzeuge_oem1_typ11_format, by = c("IDNummer" = "ID_Fahrzeug"))

zulassungen_oem1_typ12 <- zulassungen_filter %>% 
  inner_join(fahrzeuge_oem1_typ12_format, by = c("IDNummer" = "ID_Fahrzeug"))

zulassungen_oem1_typ21 <- zulassungen_filter %>% 
  inner_join(fahrzeuge_oem2_typ21_format, by = c("IDNummer" = "ID_Fahrzeug"))

zulassungen_oem1_typ22 <- zulassungen_filter %>% 
  inner_join(fahrzeuge_oem2_typ22_format, by = c("IDNummer" = "ID_Fahrzeug"))

final_data_list <- list(zulassungen_oem1_typ11, zulassungen_oem1_typ12, zulassungen_oem1_typ21, zulassungen_oem1_typ22)

final_data_set <- rbindlist(final_data_list)

```
